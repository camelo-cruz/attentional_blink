This is the QUEST algorithm